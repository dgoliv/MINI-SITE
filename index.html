<!DOCTYPE html>
<html lang="pt-br">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

    
    <style>
    
        body {
        font-family: 'Roboto', sans-serif;
    }

    /* Seletor universal para aplicar a fonte a todos os elementos de texto */
    * {
        font-family: 'Roboto', sans-serif;
    }
        
        .cards-container {
            display: flex;
            
            justify-content: center;
            flex-wrap: wrap;
            
            margin-top: 5px;
            margin-right: 5px;
            margin-left: 5px;
            
        }
        
        
        
        
        h2 {
            font-size: 27px;
            font-family: 'Roboto', sans-serif;
            text-align: center; /* Centralizar o texto */
            margin-top: 30px;
            margin-bottom: 12px;
        }
        
        h6 {
            font-size: 14px;
            font-family: 'Roboto', sans-serif;
            text-align: center; /* Centralizar o texto */
            margin-top: -10px;
            
           
        }
        
         /* Estilos para os cards */
        .card-1 {
            background-color: #e87d7d; /* Vermelho claro */
            display: flex;
            border: 10px; /* Remover borda */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Sombra sutil */
            height: 62px;
            margin-bottom: 2px; /* Espaço entre os cards quando estão em linha */
            margin-right: -12px; /* Espaço horizontal entre os cards */
            margin-left: -12px; /* Espaço horizontal entre os cards */
            text-align: center; /* Centralizar o texto */
            border-radius: 4px;
           
        }
        
        
        .card-2 {
            background-color: #f0a475; /* Verde claro */
            border: 10px; /* Remover borda */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Sombra sutil */
            height: 62px;
            margin-bottom: 10px; /* Espaço entre os cards quando estão em linha */
            margin-right: -12px; /* Espaço horizontal entre os cards */
            margin-left: -12px; /* Espaço horizontal entre os cards */
            text-align: center; /* Centralizar o texto */
            border-radius: 4px;
        }

        .card-3 {
            background-color: #edcb82; /* Amarelo claro */
            border: 5px; /* Remover borda */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Sombra sutil */
            height: 62px;
            margin-bottom: 10px; /* Espaço entre os cards quando estão em linha */
            margin-right: -12px; /* Espaço horizontal entre os cards */
            margin-left: -12px; /* Espaço horizontal entre os cards */
            text-align: center; /* Centralizar o texto */
            border-radius: 4px;
        }

        .card-4 {
            background-color: #8adb99; /* Azul claro */
            border: 10px; /* Remover borda */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Sombra sutil */
            height: 62px;
            margin-bottom: 2px; /* Espaço entre os cards quando estão em linha */
            margin-right: -12px; /* Espaço horizontal entre os cards */
            margin-left: -12px; /* Espaço horizontal entre os cards */
            text-align: center; /* Centralizar o texto */
            border-radius: 4px;
        }

        .card-5 {
            background-color: #84b6f4; /* Azul claro mais claro */
            border: 10px; /* Remover borda */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Sombra sutil */
            height: 62px;
            margin-bottom: 10px; /* Espaço entre os cards quando estão em linha */
            margin-right: -12px; /* Espaço horizontal entre os cards */
            margin-left: -12px; /* Espaço horizontal entre os cards */
            text-align: center; /* Centralizar o texto */
            border-radius: 4px;
        }
        
        .card-6 {
            background-color: #b4b4b4; /* Azul claro mais claro */
            border: 10px; /* Remover borda */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Sombra sutil */
            height: 62px;
            margin-bottom: 10px; /* Espaço entre os cards quando estão em linha */
            margin-right: -12px; /* Espaço horizontal entre os cards */
            margin-left: -12px; /* Espaço horizontal entre os cards */
            text-align: center; /* Centralizar o texto */
            border-radius: 4px;
        }
        
        .card-text {
            font-size: 18px; /* Aumentar o tamanho da fonte dos números */
            margin-top: -9.5px;
            font-family: 'Roboto', sans-serif;
            color: #323232;
            font-weight: bold;
            margin-bottom: -20px;
            margin-right: -17px; /* Espaço horizontal entre os cards */
            margin-left: -16px; /* Espaço horizontal entre os cards */
        }
        
        /* Estilos para os botões neutros */
        .btn-neutro {
            background-color: #f8f9fa; /* Cinza claro */
            color: #212529; /* Cor de texto padrão */
            margin-right: 5px;
        }
        
       #filtro-contas-pagar .text-right button {
            margin-top: 10px; /* Adicione a margem acima do botão */
            margin-bottom: 10px; /* Adicione a margem abaixo do botão */
            
        }
         /* Novo estilo para posicionar os botões "Editar" e "Excluir" à direita */
        .editar-excluir-buttons {
        display: flex;
        
        justify-content: flex-end; /* Alinhar à direita */
        margin-top: -50px; /* Ajustar o espaçamento superior para subir mais os botões */
        margin-bottom: 25px;
        }

        
        
        /* Espaçamento entre os botões no dropdown */
        /* Alinhar a lista de itens do dropdown à direita */
        .dropdown-menu.dropdown-menu-right {
            right: 0;
            left: auto;
        }
        
        .editar-excluir-dropdown {
        display: flex;
        justify-content: flex-end; /* Alinhar à direita */
        margin-top: -60px; /* Ajustar o espaçamento superior para subir mais os botões */
        margin-bottom: 30px;
        left:10px;
        top: -15px;
        
        
        }
        .editar-excluir-dropdown2 {
        display: flex;
        justify-content: flex-end; /* Alinhar à direita */
        margin-top: -60px; /* Ajustar o espaçamento superior para subir mais os botões */
        margin-bottom: 30px;
        left:10px;
        top: -2px;
        
        }
        .form-containerB {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
        margin-left: -16px;
        }

      
        
        
    </style>
    
</head>
<body>
    
    
    
    
    <div class="container md-3"> <!-- FORMULÁRIO GERAL -->
  
        
    <div id="cards-container" class="form-container"> <!-- FORMULÁRIO DOS CARDS -->
    
        <h2 class="mt-6 mb-3">CONTROLE DE BOLETOS</h2>
        <div class="row mt-6">
    <div class="col-4">
        <div class="card-1">
            <div class="card-body">
                <h6 class="card-title">Atrasados</h6>
                <p class="card-text" id="contasVencidasCount">Carregando...</p>
            </div>
            
        </div>
    </div>
    <div class="col-4">
        <div class="card-2">
            <div class="card-body">
                <h6 class="card-title">Hoje</h6>
                <p class="card-text" id="contasHojeCount">Carregando...</p>
            </div>
        </div>
    </div>
    <div class="col-4">
    <div class="card-3">
        <div class="card-body">
            <h6 class="card-title">Amanhã</h6>
            <p class="card-text" id="contasAmanhaCount">Carregando...</p>
        </div>
    </div>
</div>
    <div class="col-4">
        <div class="card-4">
            <div class="card-body">
                <h6 class="card-title">No prazo</h6>
                <p class="card-text" id="contasAVencerCount">Carregando...</p>
            </div>
        </div>
    </div>
    <div class="col-4">
    <div class="card-5">
        <div class="card-body">
            <h6 class="card-title">Pagos</h6>
            <p class="card-text" id="contasPagasCount">Carregando...</p>
        </div>
    </div>
</div>

    <div class="col-4">
        <div class="card-6">
            <div class="card-body">
                <h6 class="card-title">Total</h6>
                <p class="card-text" id="totalContasCount">Carregando...</p>
            </div>
        </div>
    </div>
</div>


<!-- Modal do Formulário de Cadastro de Fornecedores -->
<div class="modal fade" id="cadastroModal" tabindex="-1" role="dialog" aria-labelledby="cadastroModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cadastroModalLabel">Cadastro de Fornecedores</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="cadastroForm">
                    <div class="form-group">
                        <label for="fornecedor">Fornecedor:</label>
                        <input type="text" class="form-control" id="fornecedor" required>
                    </div>
                    <div class="form-group">
                        <label for="vendedor">Vendedor:</label>
                        <input type="text" class="form-control" id="vendedor" required>
                    </div>
                    <div class="form-group">
                        <label for="telefone">Telefone:</label>
                        <input type="text" class="form-control" id="telefone" required>
                    </div>
                    <button type="submit" class="btn btn-primary" id="cadastrarBtn">Cadastrar Fornecedor</button>
                </form>
            </div>
        </div>
    </div>
</div>

        <h2 class="mt-5">FORNECEDORES</h2>

        <!-- Formulário de Cadastro de Fornecedores -->
        <div id="fornecedor-form" class="form-container">
        <div class="form-containerB">
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#cadastroModal" style="margin: 15px;">✚</button>
    <input type="text" class="form-control" id="filtroFornecedores" placeholder="Digite o nome do fornecedor" oninput="filtrarFornecedores()">
</div>

 </div>

        <ul id="fornecedoresList" class="list-group">
    <!-- Lista de fornecedores será exibida aqui -->
    <li class="list-group-item d-flex justify-content-between align-items-center">
        <div>
            <strong>Fornecedor:</strong> <span class="fornecedor-nome"></span><br>
            <strong>Vendedor:</strong> <span class="fornecedor-vendedor"></span><br>
            <strong>Telefone:</strong> <span class="fornecedor-telefone"></span><br>
        </div>
        <div>
            <button class="btn btn-sm btn-info ml-2 btn-neutro editar-btn" data-id="">Editar</button>
            <button class="btn btn-sm btn-danger ml-2 btn-neutro excluir-btn" data-id="">Excluir</button>
        </div>
    </li>
</ul>

    </div>
    
    
     <!-- Formulário de Contas à Pagar -->
        <div id="contas-pagar-form" class="form-container">
            
        
        
        
        <!-- Modal do Formulário de Cadastro de Contas a Pagar -->
        <div class="modal fade" id="contasPagarModal" tabindex="-1" role="dialog" aria-labelledby="contasPagarModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="contasPagarModalLabel">Cadastro de Contas a Pagar</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="contasPagarForm">
                         <div class="form-group">
        <label for="fornecedorSelect">Fornecedor:</label>
        <select class="form-control" id="fornecedorSelect" required>
            <!-- Opções de fornecedores serão carregadas aqui -->
        </select>
    </div>
    <div class="form-group">
        <label for="codigoBarras">Código de Barras:</label>
        <input type="text" class="form-control" id="codigoBarras" required>
    </div>
    <div class="form-group">
        <label for="dataVencimento">Data de Vencimento:</label>
        <input type="date" class="form-control" id="dataVencimento" required>
    </div>
    <div class="form-group">
        <label for="valor">Valor:</label>
        <input type="number" step="0.01" class="form-control" id="valor" required>
    </div>
    <div class="form-group">
        <label for="dataPagamento">Data de Pagamento:</label>
        <input type="date" class="form-control" id="dataPagamento">
    </div>
    <button type="submit" class="btn btn-primary">Cadastrar Conta</button>
</form>
                        
        </div>
    </div>
</div>
</div>

            
  <h2 class="mt-5">BOLETOS</h2> 
<div id="filtro-contas-pagar" class="form-container">
    <div class="form-group-3">
        <div class="row">
            <div class="col-6">
                <label for="dataVencimentoInicial" class="small">Data de Vencimento Inicial:</label>
                <input type="date" class="form-control" id="dataVencimentoInicial">
            </div>
            <div class="col-6">
                <label for="dataVencimentoFinal" class="small">Data de Vencimento Final:</label>
                <input type="date" class="form-control" id="dataVencimentoFinal">
            </div>
        </div>
        
        <div class="row">
            <div class="col-6">
                <label for="dataPagamentoInicial" class="small">Data de Pagamento Inicial:</label>
                <input type="date" class="form-control" id="dataPagamentoInicial">
            </div>
            <div class="col-6">
                <label for="dataPagamentoFinal" class="small">Data de Pagamento Final:</label>
                <input type="date" class="form-control" id="dataPagamentoFinal">
            </div>
        </div>

        <div class="text-right mt-2"> <!-- Alinha o botão ao lado direito -->
            <button id="limparCamposButton" class="btn btn-primary" onclick="limparCampos()" >Limpar</button>
            <button type="button" class="btn btn-primary" id="filtrarContasBtn">Filtrar Contas</button>
        </div>
        
        
            <div class="form-containerB">
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#contasPagarModal" style="margin: 15px;">
            ✚
        </button>
            <input type="text" class="form-control" id="filtroFornecedorContas" placeholder="Digite o nome do fornecedor" oninput="filtrarContasPorFornecedor()">
        </div>
        
        
        <ul id="contasPagarList" class="list-group">
            <!-- Lista de contas a pagar será exibida aqui -->
        </ul>
 


    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script>
        const firebaseConfig = {
        apiKey: "AIzaSyC-AZzKXWy6_mvNcF8QZWuusTjpo6Dj2Hw",
        authDomain: "projetoweb-6232c.firebaseapp.com",
        databaseURL: "https://projetoweb-6232c.firebaseio.com",
        projectId: "projetoweb-6232c",
        storageBucket: "projetoweb-6232c.appspot.com",
        messagingSenderId: "341899111399",
        appId: "1:341899111399:web:3c5edd575a96808c786b42"
        };

        firebase.initializeApp(firebaseConfig);

        const db = firebase.firestore();
        const cadastroForm = document.getElementById('cadastroForm');
        const fornecedoresList = document.getElementById('fornecedoresList');
        const cadastrarBtn = document.getElementById('cadastrarBtn');
        let editingItemId = null;
        const fornecedorSelect = document.getElementById('fornecedorSelect');
        const contasPagarForm = document.getElementById('contasPagarForm');
   
    const codigoBarras = document.getElementById('codigoBarras');
    const dataVencimento = document.getElementById('dataVencimento');
    const valor = document.getElementById('valor');
    const dataPagamento = document.getElementById('dataPagamento');
    const cadastrarContaBtn = document.querySelector('#contasPagarForm button[type="submit"]');
    let editingItemIdConta = null;

        cadastroForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const fornecedor = document.getElementById('fornecedor').value;
            const vendedor = document.getElementById('vendedor').value;
            const telefone = document.getElementById('telefone').value;

            if (editingItemId) {
                await db.collection('fornecedores').doc(editingItemId).update({
                    fornecedor,
                    vendedor,
                    telefone
                });

                cadastrarBtn.textContent = "Cadastrar Fornecedor";
                editingItemId = null;
            } else {
                await db.collection('fornecedores').add({
                    fornecedor,
                    vendedor,
                    telefone
                });
            }

            cadastroForm.reset();
            $('#cadastroModal').modal('hide'); // Fechar o modal após cadastrar ou editar

        });

        db.collection('fornecedores').onSnapshot(snapshot => {
        fornecedorSelect.innerHTML = ''; // Limpa a lista suspensa antes de adicionar novos itens
        fornecedoresList.innerHTML = '';
        snapshot.forEach(doc => {
        const data = doc.data();
        const fornecedoresList = document.getElementById('fornecedoresList');
        const option = document.createElement('option');
        option.textContent = data.fornecedor;
        fornecedorSelect.appendChild(option);
        const listItem = document.createElement('li');
        listItem.classList.add('list-group-item');
        listItem.innerHTML = `
                    
                    <div>
                    <strong>Fornecedor:</strong>
                    <strong class="fornecedor-nome">${data.fornecedor}</strong><br>
                    <strong>Vendedor:</strong> ${data.vendedor}<br>
                    <strong>Telefone:</strong> ${data.telefone}
                    
                    <div class="dropdown editar-excluir-dropdown">
        <button class="btn btn-sm btn-secondary dropdown-toggle" type="button" id="editarExcluirDropdown_${doc.id}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-flip="false">
            
        </button>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="editarExcluirDropdown_${doc.id}">
            <button class="dropdown-item editar-btn" data-id="${doc.id}">✎ Editar</button>
            <button class="dropdown-item excluir-btn" data-id="${doc.id}">✘ Excluir</button>
        </div>
    </div>
`;

// Adicionar evento de clique para abrir o dropdown ao clicar no botão "Ações"
const dropdownButton = listItem.querySelector(`#editarExcluirDropdown_${doc.id}`);
const dropdownMenu = listItem.querySelector(`#editarExcluirDropdown_${doc.id} + .dropdown-menu`);

dropdownButton.addEventListener('click', () => {
    dropdownMenu.classList.toggle('show');
});
                
                fornecedoresList.appendChild(listItem);
            });

            const editarButtons = document.querySelectorAll('.editar-btn');
            const excluirButtons = document.querySelectorAll('.excluir-btn');

            editarButtons.forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const id = e.target.getAttribute('data-id');
                    editingItemId = id;
                    const doc = await db.collection('fornecedores').doc(id).get();
                    const data = doc.data();
                    document.getElementById('fornecedor').value = data.fornecedor;
                    document.getElementById('vendedor').value = data.vendedor;
                    document.getElementById('telefone').value = data.telefone;
                    cadastrarBtn.textContent = "Salvar Edições";
                    
                    // Fechar o dropdown após clicar em "Editar"
                    const dropdown = btn.closest('.dropdown');
                    const dropdownToggle = dropdown.querySelector('.dropdown-toggle');
                    dropdownToggle.click();
                 // Abrir o modal de cadastro de fornecedores
                    $('#cadastroModal').modal('show');
                });
            });

            excluirButtons.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = e.target.getAttribute('data-id');
                    db.collection('fornecedores').doc(id).delete();
                    
                    const dropdown = btn.closest('.dropdown');
                    const dropdownToggle = dropdown.querySelector('.dropdown-toggle');
                    dropdownToggle.click();
                    
                });
            });
            
            contasPagarForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const fornecedorId = fornecedorSelect.value;
    const codigo = codigoBarras.value;
    const vencimento = dataVencimento.value;
    const valorConta = parseFloat(valor.value);
    const pagamento = dataPagamento.value;
   


    
if (editingItemIdConta) {
        await db.collection('contasPagar').doc(editingItemIdConta).update({
            fornecedorId,
            codigo,
            vencimento,
            valor: valorConta,
            pagamento
        });

        cadastrarContaBtn.textContent = "Cadastrar Conta";
        editingItemIdConta = null;

        
        $('#contasPagarModal').modal('hide');
    } else {
        await db.collection('contasPagar').add({
            fornecedorId,
            codigo,
            vencimento,
            valor: valorConta,
            pagamento
        });
    }

    contasPagarForm.reset();
    $('#contasPagarModal').modal('hide');
});

            
        });
        
        
        
        
        db.collection('contasPagar').onSnapshot(snapshot => {
    contasPagarList.innerHTML = '';
    snapshot.forEach(doc => {
        const data = doc.data();
        const dataVencimentoFormatada = new Date(data.vencimento + 'T00:00:00').toLocaleDateString('pt-BR', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric'
        });

        const dataPagamentoFormatada = data.pagamento ? new Date(data.pagamento + 'T00:00:00').toLocaleDateString('pt-BR', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric'
        }) : 'Não pago';

        const listItem = document.createElement('li');
        listItem.classList.add('list-group-item');
        listItem.setAttribute('data-vencimento', data.vencimento); // Adicionar o atributo data-vencimento
        listItem.setAttribute('data-pagamento', data.pagamento || ''); // Adicionar o atributo data-pagamento (ou vazio se não houver pagamento)
        listItem.innerHTML = `
        <div class="d-flex justify-content-between align-items-center">
        <div>
            <strong>Fornecedor:</strong>
            <strong class="nome-fornecedor">${data.fornecedorId}</strong><br>
            <strong>Código de Barras:</strong> ${data.codigo}<br>
            <strong>Data de Vencimento:</strong> ${dataVencimentoFormatada}<br>
            <strong>Valor:</strong> R$ 
            <class="item-valor">${data.valor.toFixed(2)}<br>
            <strong>Data de Pagamento:</strong> ${dataPagamentoFormatada}<br>
            </div>
            <div class="dropdown editar-excluir-dropdown2">
                <button class="btn btn-sm btn-secondary dropdown-toggle" type="button" id="dropdown_${doc.id}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-flip="false">
                    
                </button>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown_${doc.id}">
                    <button class="dropdown-item editar-conta-btn" data-id="${doc.id}">✎ Editar</button>
                    <button class="dropdown-item excluir-conta-btn" data-id="${doc.id}">✘  Excluir</button>
                </div>
            </div>
        </div>
    `;
        contasPagarList.appendChild(listItem);
        
        // Adicionar evento de clique no botão "Ações" para abrir o dropdown
    const dropdownButton = listItem.querySelector(`#dropdown_${doc.id}`);
    const dropdownMenu = listItem.querySelector(`#dropdown_${doc.id} + .dropdown-menu`);
    dropdownButton.addEventListener('click', () => {
        dropdownMenu.classList.toggle('show');
        // Abre o modal de cadastro/edição
        
        
    });
        
    // Adicionar evento de clique no botão "Editar"
    const editarBtn = listItem.querySelector('.editar-conta-btn');
    editarBtn.addEventListener('click', () => {
        const contaId = editarBtn.getAttribute('data-id');
        dropdownMenu.classList.toggle('show');
        $('#contasPagarModal').modal('show');
        
        
        
        abrirFormularioEdicao(contaId); // Função para abrir o formulário de edição
        
        
    });

    // Adicionar evento de clique no botão "Excluir"
    const excluirBtn = listItem.querySelector('.excluir-conta-btn');
    excluirBtn.addEventListener('click', () => {
        const contaId = excluirBtn.getAttribute('data-id');
        // Lógica para confirmar a exclusão da conta com o ID e excluir
        console.log(`Excluir conta com ID ${contaId}`);
    });
        
    });

   const editarContaButtons = document.querySelectorAll('.editar-conta-btn');
    const excluirContaButtons = document.querySelectorAll('.excluir-conta-btn');

    editarContaButtons.forEach(btn => {
        btn.addEventListener('click', async (e) => {
            const id = e.target.getAttribute('data-id');
            editingItemIdConta = id;
            const doc = await db.collection('contasPagar').doc(id).get();
            const data = doc.data();
            fornecedorSelect.value = data.fornecedorId;
            codigoBarras.value = data.codigo;
            dataVencimento.value = data.vencimento;
            valor.value = data.valor;
            dataPagamento.value = data.pagamento;
            cadastrarContaBtn.textContent = "Salvar Edições";
      
            
        });
    });

    excluirContaButtons.forEach(btn => {
        btn.addEventListener('click', async (e) => {
            const id = e.target.getAttribute('data-id');
            await db.collection('contasPagar').doc(id).delete();
        });
    });
    
    
        
    
    
    // Atualizar os cards no topo com informações sobre os valores das contas
// Função para formatar a data em formato pt-BR
function formatarData(data) {
    const options = { year: 'numeric', month: '2-digit', day: '2-digit' };
    return new Intl.DateTimeFormat('pt-BR', options).format(data);
}

// Atualizar os cards no topo com informações sobre os valores das contas
db.collection('contasPagar').onSnapshot(snapshot => {
    const hoje = new Date();
    const amanha = new Date();
    amanha.setDate(hoje.getDate() + 1); // Definir a data para amanhã
    let totalContasVencidas = 0;
    let totalContasHoje = 0;
    let totalContasAVencer = 0;
    let totalContasPagas = 0;
    let totalContasAmanha = 0; // Inicializar total para amanhã

    snapshot.docs.forEach(doc => {
            const data = doc.data();
            const dataVencimento = new Date(data.vencimento + 'T00:00:00');
            const valorConta = data.valor;
            const dataPagamento = data.pagamento ? new Date(data.pagamento + 'T00:00:00') : null;

            if (dataVencimento.toDateString() === hoje.toDateString()) {
                if (!dataPagamento) {
                    totalContasHoje += valorConta;
                }
            } else if (dataVencimento < hoje) {
                if (!dataPagamento)
                    totalContasVencidas += valorConta;
            } else if (dataVencimento.toDateString() === amanha.toDateString()) { // Verificar se a conta é para amanhã
                if (!dataPagamento)
                    totalContasAmanha += valorConta;
            } else if (!dataPagamento) {
                totalContasAVencer += valorConta;
            }
            if (data.pagamento) {
                totalContasPagas += data.valor;
            }
        });

        const totalContas = totalContasVencidas + totalContasHoje + totalContasAmanha +totalContasAVencer + totalContasPagas;

        document.getElementById('contasVencidasCount').textContent = `R$ ${totalContasVencidas.toFixed(2)}`;
        document.getElementById('contasHojeCount').textContent = `R$ ${totalContasHoje.toFixed(2)}`;
        document.getElementById('contasAVencerCount').textContent = `R$ ${totalContasAVencer.toFixed(2)}`;
        document.getElementById('totalContasCount').textContent = `R$ ${totalContas.toFixed(2)}`;
        document.getElementById('contasPagasCount').textContent = `R$ ${totalContasPagas.toFixed(2)}`;
        document.getElementById('contasAmanhaCount').textContent = `R$ ${totalContasAmanha.toFixed(2)}`; // Exibir total para amanhã


    });

    function filtrarContasPorFornecedor() {
        const filtroInput = document.getElementById('filtroFornecedorContas');
        const contasPagarList = document.getElementById('contasPagarList');
        const contasItens = contasPagarList.getElementsByClassName('list-group-item');

        const filtro = filtroInput.value.toLowerCase();

        for (const item of contasItens) {
            const fornecedorNome = item.querySelector('.nome-fornecedor').textContent.toLowerCase();
            if (fornecedorNome.includes(filtro)) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        }
    }

    document.getElementById('filtroFornecedorContas').addEventListener('input', filtrarContasPorFornecedor);


    function filtrarFornecedores() {
        const filtroInput = document.getElementById('filtroFornecedores');
        const fornecedoresList = document.getElementById('fornecedoresList');
        const fornecedoresItens = fornecedoresList.getElementsByClassName('list-group-item');

        const filtro = filtroInput.value.toLowerCase();

        for (const item of fornecedoresItens) {
            const fornecedorNome = item.querySelector('.fornecedor-nome').textContent.toLowerCase();
            if (fornecedorNome.includes(filtro)) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        }
    }


document.getElementById('filtroFornecedores').addEventListener('input', filtrarFornecedores);

    
    


});

// Função para limpar os campos de data
    function limparCampos() {
        dataVencimentoInicial.value = '';
        dataVencimentoFinal.value = '';
        dataPagamentoInicial.value = '';
        dataPagamentoFinal.value = '';
        
    }


// Selecionar os elementos de input para as datas de vencimento e pagamento
const dataVencimentoInicial = document.getElementById('dataVencimentoInicial');
const dataVencimentoFinal = document.getElementById('dataVencimentoFinal');
const dataPagamentoInicial = document.getElementById('dataPagamentoInicial');
const dataPagamentoFinal = document.getElementById('dataPagamentoFinal');
const filtrarContasBtn = document.getElementById('filtrarContasBtn');

// Função para atualizar a lista de contas a pagar com base nos filtros de data
filtrarContasBtn.addEventListener('click', () => {
    const contasPagarList = document.getElementById('contasPagarList');
    const contasItens = contasPagarList.getElementsByClassName('list-group-item');

    const filtroDataVencimentoInicial = dataVencimentoInicial.value ? new Date(dataVencimentoInicial.value) : null;
    const filtroDataVencimentoFinal = dataVencimentoFinal.value ? new Date(dataVencimentoFinal.value) : null;
    const filtroDataPagamentoInicial = dataPagamentoInicial.value ? new Date(dataPagamentoInicial.value) : null;
    const filtroDataPagamentoFinal = dataPagamentoFinal.value ? new Date(dataPagamentoFinal.value) : null;

    for (const item of contasItens) {
        const dataVencimento = new Date(item.getAttribute('data-vencimento'));
        const dataPagamento = new Date(item.getAttribute('data-pagamento'));

        const vencimentoDentroDoFiltro = (
            (!filtroDataVencimentoInicial || dataVencimento >= filtroDataVencimentoInicial) &&
            (!filtroDataVencimentoFinal || dataVencimento <= filtroDataVencimentoFinal)
        );

        const pagamentoDentroDoFiltro = (
            (!filtroDataPagamentoInicial || dataPagamento >= filtroDataPagamentoInicial) &&
            (!filtroDataPagamentoFinal || dataPagamento <= filtroDataPagamentoFinal)
        );

        if ((vencimentoDentroDoFiltro && pagamentoDentroDoFiltro) || (!filtroDataVencimentoInicial && !filtroDataVencimentoFinal && !filtroDataPagamentoInicial && !filtroDataPagamentoFinal)) {
            item.style.display = 'block';
        } else {
            item.style.display = 'none';
        }
    }
});

// Adicionar evento de clique para o botão de filtragem
filtrarContasBtn.addEventListener('click', filtrarContas);

        
   </script>
</body>
</html>
